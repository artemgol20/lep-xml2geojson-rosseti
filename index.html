<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Line Visualization</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
    
    <style>
        #map { height: 500px;
        z-index: 1; }
        #graph { height: 400px; }
         #detailModal {
        z-index: 50; /* Убедимся, что окно находится поверх карты */
        pointer-events: none; /* Окно не будет блокировать клики, пока не будет открыто */
    }

    #detailModal .bg-white {
        z-index: 60; /* Сами элементы модального окна выше */
        pointer-events: auto; /* Включаем обработку кликов для модального окна */
    }

    /* Убедимся, что маркеры на карте не перекрывают модальное окно */
    .leaflet-marker-icon {
        z-index: 1; /* Снижает z-index маркеров */
    }

    /* Стили для кнопки "More Info" */
    .more-info-btn {
        cursor: pointer;
    }
    </style>
</head>
<body class="bg-gray-100">
<!-- Modal -->
<div id="detailModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 pointer-events-none">
    <div class="bg-white rounded-2xl p-8 w-full max-w-2xl relative z-60 pointer-events-auto shadow-2xl border border-blue-200">
        <button id="closeModal" class="absolute top-3 right-4 text-gray-400 hover:text-blue-600 text-3xl font-bold transition-colors">&times;</button>
        <h2 class="text-2xl font-bold mb-4 text-blue-700" id="modalTitle">Details</h2>
        <div id="modalContent" class="overflow-y-auto max-h-[300px] bg-gray-50 rounded p-3 mb-4 text-gray-700 text-sm shadow-inner"></div>
        <div id="modalChart" class="mt-4 h-64"></div>
    </div>
</div>


    <div class="container mx-auto p-4">
        <h1 class="text-2xl font-bold mb-4">Power Line Visualization</h1>
        
        <!-- File Input -->
        <div class="mb-4">
            <label for="geojsonFile" class="mr-2">Upload GeoJSON File:</label>
            <input type="file" id="geojsonFile" accept=".geojson,.json" class="border p-2">
        </div>

        <!-- Filter Section -->
        <div class="mb-6 flex items-center space-x-4">
            <label for="filialFilter" class="text-lg font-medium text-gray-700">Filter by filial:</label>
            <select id="filialFilter" class="border border-blue-400 rounded-lg px-4 py-2 bg-white shadow focus:outline-none focus:ring-2 focus:ring-blue-300 transition-all duration-200">
                <option value="all">All</option>
            </select>
        </div>

        <!-- Map Section -->
        <div id="map" class="mb-8 rounded-xl shadow-lg border border-blue-200"></div>

    </div>

    <script src="js/app.js" type="module"></script>
    <script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: false });
  window.mermaid = mermaid; // делаем глобально доступным
</script>
</body>
</html>
